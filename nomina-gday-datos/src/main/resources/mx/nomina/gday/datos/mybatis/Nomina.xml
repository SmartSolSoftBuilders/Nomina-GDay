<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="mx.nomina.gday.dao.NominaDao">
	<resultMap type="Nomina" id="nominaResult">
		<result property="idNomina" column="ID_NOMINA"/>
		<result property="nombreCorto" column="NOMBRE_CORTO"/>
		<result property="provisionAguinaldo" column="PROVISION_AGUINALDO"/>
		<result property="provisionVacaciones" column="PROVISION_VACACIONES"/>
		<result property="provisionPrimaVacacional" column="PROVISION_PRIMA_VACACIONAL"/>
		<result property="diasAguinaldo" column="DIAS_AGUINALDO"/>
		<result property="porcPrimaVacacional" column="PORC_PRIMA_VACACIONAL"/>
		<result property="fondoAhorro" column="FONDO_AHORRO"/>
		<result property="facturaSubsidio" column="FACTURA_SUBSIDIO"/>
		<result property="ivaExento" column="IVA_EXENTO"/>
		<result property="reconoceAntiguedad" column="RECONOCE_ANTIGUEDAD"/>
		<result property="comisionCostSocial" column="COMISION_COST_SOCIAL"/>
		<result property="tipoPago" column="TIPO_PAGO"/>
		<result property="claseRiesgo" column="CLASE_RIESGO"/>
		<result property="registroPatronal" column="REGISTRO_PATRONAL"/>
		<result property="periodicidad" column="PERIODICIDAD"/>
		<association property="intermediaria" column="ID_INTERMEDIARIA" javaType="Intermediaria" select="selectIntermediaria"/>
		<association property="patrona" column="ID_PATRONA" javaType="Patrona" select="selectPatrona"/>
		<association property="ejecutivo" column="ID_EJECUTIVO" javaType="Ejecutivo" select="selectEjecutivo"/>
		<association property="esquema" column="ID_ESQUEMA" javaType="Esquema" select="selectEsquema"/>
		<association property="tipoCalendario" column="ID_CALENDARIO" javaType="TipoCalendario" select="selectTipoCalendario"/>				
	</resultMap>
	
	<resultMap id="intermediariaResult" type="Intermediaria">
    	<id property="idIntermediaria" column="ID_INTERMEDIARIA"/>
		<result property="nombreIntermediaria" column="NOMBRE_INTERMEDIARIA"/>					  		
	</resultMap>
	
	<resultMap id="ejecutivoResult" type="Ejecutivo">
    	<id property="idEjecutivo" column="ID_EJECUTIVO"/>
		<result property="nombreEjecutivo" column="NOMBRE_EJECUTIVO"/>
		<result property="paternoEjecutivo" column="APP_PATERNO_EJECUTIVO"/> 
		<result property="maternoEjecutivo" column="APP_MATERNO_EJECUTIVO"/>			  		
	</resultMap>
	
	<resultMap id="esquemaResult" type="Esquema">
    	<id property="idEsquema" column="ID_ESQUEMA"/>
		<result property="nombreEsquema" column="NOMBRE_ESQUEMA"/>
					  		
	</resultMap>
	
	<resultMap id="tipoCalendarioResult" type="TipoCalendario">
    	<id property="idCalendario" column="ID_CALENDARIO"/>
		<result property="tipoCalendario" column="TIPO_CALENDARIO"/>
		<result property="siglas" column="SIGLAS"/>
		<result property="pr" column="PR"/>
			
	</resultMap>
	
	<select id="selectIntermediaria" parameterType="int" resultMap="intermediariaResult" resultType="Intermediaria">		 
		select * from "INTERMEDIARIA" where "ID_INTERMEDIARIA"=#{idIntermediaria} 	
	</select> 
	
	<select id="selectEjecutivo" parameterType="int" resultMap="ejecutivoResult" resultType="Ejecutivo">		 
		select * from "EJECUTIVO" where "ID_EJECUTIVO"=#{idEjecutivo} 	
	</select> 
	
	<select id="selectEsquema" parameterType="int" resultMap="esquemaResult" resultType="Esquema">		 
		select * from "ESQUEMA" where "ID_ESQUEMA"=#{idEsquema} 	
	</select> 
	
	
	<select id="selectTipoCalendario" parameterType="int" resultMap="tipoCalendarioResult" resultType="TipoCalendario">		 
		select * from "TIPO_CALENDARIO" where "ID_CALENDARIO"=#{idCalendario} 	
	</select> 

	<insert id="agregarNomina" parameterType="Nomina" keyProperty="id">
		<selectKey keyProperty="id" resultType="long" order="BEFORE">
  		   	SELECT nextVal('sec_nomina')
  		</selectKey>
  		
  		INSERT INTO "NOMINA"(
            "ID_NOMINA", "ID_PATRONA", "ID_INTERMEDIARIA", "ID_ESQUEMA", "ID_EJECUTIVO", 
            "ID_CALENDARIO", "NOMBRE_CORTO", "PROVISION_AGUINALDO", 
            "PROVISION_VACACIONES", "PROVISION_PRIMA_VACACIONAL", "DIAS_AGUINALDO", 
            "PORC_PRIMA_VACACIONAL", "FONDO_AHORRO", "FACTURA_SUBSIDIO", 
            "IVA_EXENTO", "RECONOCE_ANTIGUEDAD", "COMISION_COST_SOCIAL", 
            "TIPO_PAGO", "CLASE_RIESGO", "REGISTRO_PATRONAL", "PERIODICIDAD")
   	 	VALUES (#{id}, 1, 1, 1, 1, 1, #{nombreCorto},  #{provisionAguinaldo},  #{provisionVacaciones}, 
            #{provisionPrimaVacacional}, #{diasAguinaldo}, #{porcPrimaVacacional}, #{fondoAhorro}, 
            #{facturaSubsidio}, #{ivaExento}, #{reconoceAntiguedad}, 
            #{comisionCostSocial}, #{tipoPago}, #{claseRiesgo}, 
            #{registroPatronal}, #{periodicidad});	
	</insert>
</mapper>